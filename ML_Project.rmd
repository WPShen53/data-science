---
library(caret); library(rpart); library(klaR)
set.seed(123456)
data <- read.csv("pml-training.csv", na.strings = c("", "#DIV/0!", "NA"), 
                 row.names=1, stringsAsFactors=FALSE)
data <- data[,colSums(is.na(data))<0.9*nrow(data)] # remove the column is 90% NA
data$classe <- factor(data$classe)
inTrain <- createDataPartition(data$classe, p=0.8, list=FALSE, times=1)
training <- data[inTrain,]
testing <- data[-inTrain,]
fit1 <- train(classe~., method="rpart", data=training)
importance <- varImp(fit1)
